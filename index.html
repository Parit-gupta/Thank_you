<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Thank You</title>
    <link rel="stylesheet" href="style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Poppins:wght@300;500&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <audio id="bg-music" loop>
      <source src="tenderness.mp3" type="audio/mp3" />
    </audio>

    <audio id="click-sound">
      <source src="mouse-click-290204.mp3" type="audio/mp3" />
    </audio>

    <audio id="type-sound">
      <source src="mouse-click-290204.mp3" type="audio/mp3" />
    </audio>

    <div id="author-name" class="top-right-name" style="opacity: 0">
      Parit Gupta
    </div>

    <div id="start-overlay">
      <div class="rgb-glow">
        <button id="start-btn">Start</button>
        <div class="rgb-waves"></div>
      </div>
      <div class="funny-intro-text">
        <p id="funny-line"></p>
      </div>
    </div>

    <div class="image-wrapper">
      <img
        src="WhatsApp Image 2025-06-25 at 21.13.54_947c8292.jpg"
        class="crazy-img"
        alt="Collage Image 1"
      />
      <img
        src="WhatsApp Image 2025-06-16 at 21.46.49_dbbfd12c.jpg"
        class="crazy-img"
        alt="Collage Image 2"
      />
      <img src="1720469259785.jpg" class="crazy-img" alt="Collage Image 3" />
      <img src="1733125014334.jpg" class="crazy-img" alt="Collage Image 4" />
      <img
        src="WhatsApp Image 2025-06-28 at 22.21.57_b0ab55f2.jpg"
        class="crazy-img"
        alt="Collage Image 5"
      />
      <img src="" class="crazy-img" alt="Collage Image 6" />
      <img src="" class="crazy-img" alt="Collage Image 7" />
      <img src="" class="crazy-img" alt="Collage Image 8" />
      <img src="" class="crazy-img" alt="Collage Image 9" />
      <img src="" class="crazy-img" alt="Collage Image 10" />
    </div>

    <div id="intro-overlay">
      <img
        src="WhatsApp Image 2025-06-21 at 01.23.58_812f7b14.jpg"
        alt="Cosmic Void"
      />
    </div>

    <div class="sky">
      <div class="sky-overlay"></div>
      <div class="stars">
        <div class="aurora"></div>
      </div>

      <h1 class="typing">
        Thank You, Didi and Bhaiya for spending time with me!
      </h1>

      <div class="card-container">
        <div class="card">
          <div class="card-image-slider">
            <img src="1691658549571.jpg" alt="Somya 1" />
            <img
              src="WhatsApp Image 2025-06-23 at 18.21.59_e26f18cc.jpg"
              alt="Somya 2"
            />
            <img
              src="WhatsApp Image 2025-06-28 at 10.23.32_fef7d400.jpg"
              alt="Somya 3"
            />
            <img
              src="WhatsApp Image 2025-06-28 at 10.23.34_473e638b.jpg"
              alt="Somya 4"
            />
          </div>
          <h2>Somya Didi</h2>
          <button onclick="openModal('modal1')">Click Here</button>
        </div>

        <div class="card">
          <div class="card-image-slider">
            <img
              src="WhatsApp Image 2025-06-21 at 00.27.58_29b00553.jpg"
              alt="Niket 1"
            />
            <img src="1731613492852.jpg" alt="Niket 2" />
            <img
              src="WhatsApp Image 2025-06-25 at 21.13.56_1d9950a3.jpg"
              alt="Niket 3"
            />
            <img
              src="WhatsApp Image 2025-06-25 at 21.13.56_17d7ee24.jpg"
              alt="Niket 4"
            />
          </div>
          <h2>Niket Bhaiya</h2>
          <button onclick="openModal('modal2')">Click Here</button>
        </div>

        <div class="card">
          <div class="card-image-slider">
            <img src="1738405215401.jpg" alt="Anand 1" />
            <img src="1733125014334.jpg" alt="Anand 2" />
            <img
              src="WhatsApp Image 2025-06-23 at 18.22.00_105e5279.jpg"
              alt="Anand 3"
            />
            <img
              src="WhatsApp Image 2025-06-25 at 21.13.55_591e807b.jpg"
              alt="Anand 4"
            />
            <img
              src="WhatsApp Image 2025-06-25 at 21.13.55_7348ccc0.jpg"
              alt="Anand 5"
            />
            <img
              src="WhatsApp Image 2025-06-16 at 21.46.49_dbbfd12c.jpg"
              alt="Anand 5"
            />
          </div>
          <h2>Anand Bhaiya</h2>
          <button onclick="openModal('modal3')">Click Here</button>
        </div>

        <div class="card">
          <div class="card-image-slider">
            <img
              src="WhatsApp Image 2025-06-23 at 18.22.00_6bbffc67.jpg"
              alt="Sakshi 1"
            />
            <img
              src="WhatsApp Image 2025-06-22 at 00.44.01_fe570723.jpg"
              alt="Sakshi 2"
            />
            <img src="1747112239477.jpg" alt="Sakshi 3" />
            <img
              src="WhatsApp Image 2025-06-25 at 21.13.55_8b3bb490.jpg"
              alt="Sakshi 4"
            />
          </div>
          <h2>Sakshi Didi</h2>
          <button onclick="openModal('modal4')">Click Here</button>
        </div>
      </div>

      <div id="modal1" class="modal">
        <div class="modal-content">
          <span class="close top-right" onclick="closeModal('modal1')"
            >&times;</span
          >
          <h3>Somya Didi</h3>
          <p>
            Hello Didi, How’s work going on? 😄 Just kidding… so let’s start
            from here: Di, I love the way you did your work. Even when you were
            stressed out 😣, targeted unfairly, or scolded for no reason —
            sometimes even skipping lunch — the one thing you never forgot was
            to finish your work 💻. And honestly, that dedication is something I
            really admired in you. I also loved your attitude — like a truly
            loving big sister 💖. No judgments, always supportive, and always
            ready to do the craziest things 🤪. And yes, we missed one important
            thing — drinking beers together 🍻. You promised, but work came in
            between 😅. Don’t worry, we’ll make it happen next time when we meet
            again — pakka! 😎 Di, I absolutely love the way you care about
            everyone 🫶, your energy while playing pool 🎱, and the positive
            vibes that naturally come out of you ✨. Just one thing from me —
            never be sad, please 😔. And if you ever feel stressed, angry, or
            frustrated… remember, you now have a newly-made small brother 🤗.
            You can vent it all out on me — I won’t mind, not even a bit —
            because I’ve seen how much pressure you take, and honestly, I don’t
            like seeing you that way. So if you ever feel overwhelmed, talk to
            me, share it with me, don’t carry it alone 💬. I know with all my
            heart that you’ll achieve big things in your future 🚀🌟. And yes…
            please don’t roam while drinking 🥴 — I'm still your responsible lil
            bro after all 😂. Last thing, Di — I don’t know how you see me…
            maybe annoying, cute, caring, arrogant, or just carefree 🤷‍♂️. But the
            way I see you is: strong, inspiring, kind, fun, and full of life 💛.
            And I promise — when we meet next in winter, if you’re in Gurgaon —
            you’ll see a more mature version of me 🤞🙂. Till then, keep
            smiling, stay stress-free, and remember — I’m always here. 🧡Their
            is a button when you scroll down dedicated to you 😅
          </p>

          <div class="photo-gallery">
            <img
              src="WhatsApp Image 2025-06-23 at 18.21.59_e26f18cc.jpg"
              alt="Somya Extra 1"
            />
            <img src="1691658549571.jpg" alt="Somya Extra 2" />
            <img
              src="WhatsApp Image 2025-06-28 at 10.23.32_fef7d400.jpg"
              alt="Somya 3"
            />
            <img
              src="WhatsApp Image 2025-06-28 at 10.23.34_473e638b.jpg"
              alt="Somya 4"
            />
          </div>

          <div class="button-container">
            <button class="btn-somya" onclick="goToSomyaPage()">
              Go to Somya's Page
            </button>
          </div>
        </div>
      </div>

      <div id="modal2" class="modal">
        <div class="modal-content">
          <span class="close" onclick="closeModal('modal2')">&times;</span>
          <h3>Niket Bhaiya</h3>
          <p>
            Bhaiya, You’re truly one of the coolest people I know, and I
            wouldn’t want you to change a thing. I’ve always admired your sense
            of humor 😄, your kindness 🤝, and how naturally you take on the
            role of a big brother — always looking out for everyone. I love the
            way you explain things so clearly — it genuinely inspires me to
            understand better and learn more 🧠📘. And of course, I absolutely
            love watching you play pool 🎱 — you’ve got those smooth, confident
            shots. Just one small request though… please don’t smoke 🚭. It’s
            bad for your health — and honestly, we all want you to be around,
            happy and healthy, for a long time 💙🙂. I don’t know what you
            really think about me — whether I was good, annoying, or just a bit
            crazy 🙈 — but for me, spending time with you was genuinely fun and
            meaningful. Also… please never ignore me 😢. Even if I randomly
            message you sometime, just reply back — that’s all I’ll ever expect.
            Bhaiya, you once said I talk too much — well, that’s because I’m
            really like that 😅… a bit like a child who loves to irritate, joke
            around, and have fun 😜. But honestly, I’m an introvert too 🌌 —
            that’s why I didn’t speak much in the beginning. But don’t worry —
            when we meet again in December (and I hope you’ll be in Gurgaon
            then), you’ll see a more mature version of me 🤞🙂. I’m working on
            myself, and I promise you’ll see the improvement. All the very best
            for your future 🎯💼 — I know you'll do amazing things ahead. And
            BTW… please call me in your wedding! 👰‍♀️🤵‍♂️ — just kidding 😄, but
            seriously, Stay happy, stay the legend you are. 💙 — Your annoying,
            talkative, caring little brother 😁Their is a button when you scroll
            down dedicated to you 😅
          </p>
          <div class="photo-gallery">
            <img
              src="WhatsApp Image 2025-06-28 at 22.21.57_b0ab55f2.jpg"
              alt="Niket Extra 1"
            />
            <img
              src="WhatsApp Image 2025-06-21 at 00.27.58_29b00553.jpg"
              alt="Niket Extra 2"
            />
            <img
              src="WhatsApp Image 2025-06-25 at 21.13.56_1d9950a3.jpg"
              alt="Niket 3"
            />
            <img
              src="WhatsApp Image 2025-06-25 at 21.13.56_17d7ee24.jpg"
              alt="Niket 4"
            />
            <div class="button-container">
              <button class="btn-niket" onclick="goToniketPage()">
                Go to Niket's Page
              </button>
            </div>
          </div>
        </div>
      </div>

      <div id="modal3" class="modal">
        <div class="modal-content">
          <span class="close" onclick="closeModal('modal3')">&times;</span>
          <h3>Anand Bhaiya</h3>
          <p>
            Bhaiya, I truly love the way you handled your work 💼 and how you
            always guided and helped me whenever I needed it 🙌. Don’t worry —
            I’ll forever be your junior number one 🤓, always bothering you for
            help and sharing all the important things happening in my life 💬💙.
            I don’t know how you thought about me 🤔 — whether I seemed
            immature, crazy, or carefree — but this is how I always thought
            about you: with respect, admiration, and a lot of affection 🫶.
            Bhaiya, I love the way you mocked me in fun, thinking of me as that
            carefree fellow 😄 — and still, you always guided me the best way
            you could. You even gave me rides 🚗 and made me feel special. I
            especially loved the days we spent together — at Decathlon, Walmart,
            and Niket Bhaiya’s house 🏡. Those memories are precious to me. Just
            one thing… please leave smoking 🚭. Nicotex exists 👉🧃 to help you,
            and your health matters to all of us. And Bhaiya, when I leave from
            here — please don’t ignore me. Even a small reply to my messages,
            asking about my health or just saying hi — that would mean a lot 💙.
            I know you may not see me as mature right now — but when we meet
            again in December (I really hope you’ll be there), you’ll see a more
            mature, more knowledgeable version of me 💪🧠. Always stay happy
            Bhaiya 😄 — and I genuinely hope you marry the person you love 💑.
            You both deserve happiness and I hope you two stay together forever
            💍💖. I also loved the way your partner is — she’s cool,
            trustworthy, and a real swagger 😎. Thank you for everything — for
            caring for me, guiding me, laughing with me, and being the amazing
            Bhaiya you are 💙🙏. Their is a button when you scroll down
            dedicated to you 😅
          </p>
          <div class="photo-gallery">
            <img
              src="WhatsApp Image 2025-06-23 at 18.22.00_105e5279.jpg"
              alt="Anand Extra"
            />
            <img src="1738405215401.jpg" alt="Anand Extra" />
            <img src="1733125014334.jpg" alt="Anand Extra" />
            <img
              src="WhatsApp Image 2025-06-25 at 21.13.55_591e807b.jpg"
              alt="Anand 4"
            />
            <img
              src="WhatsApp Image 2025-06-25 at 21.13.55_7348ccc0.jpg"
              alt="Anand 5"
            />
            <img
              src="WhatsApp Image 2025-06-16 at 21.46.49_dbbfd12c.jpg"
              alt="Anand 5"
            />
            <div class="button-container">
              <button class="btn-anand" onclick="goToanandPage()">
                Go to Anand's Page
              </button>
            </div>
          </div>
        </div>
      </div>

      <div id="modal4" class="modal">
        <div class="modal-content">
          <span class="close" onclick="closeModal('modal4')">&times;</span>
          <h3>Sakshi Didi</h3>
          <p>
            So Di, Now let’s see what I can even say about you… I have so much,
            honestly. I learned a lot from you, and there were many things I
            truly admired — like how focused you always were in your career 🎯,
            how clearly you knew which path to follow, whose side to stand on,
            and what’s right and wrong. You always supported your friends 💛 and
            stayed away from any bad habits — that alone made you stand out. For
            me, you were like a role model ⭐. I was genuinely motivated by you,
            even though you may not have noticed. I know you didn’t really see
            me working — yeah, you even told me that 😅 — but honestly, I was
            doing my work quietly… and this message is actually a part of that
            effort 📝. I loved how you scolded me sometimes and said things
            like: “Bahar faink doongi company se” 🤣, “Pit jaayega tu merese”
            😆, and the legendary one during our driving talk — “Jis din main
            apni gaadi laaongi, sabse pehle tujhe thokungi” 🚗💥 And oh! I
            absolutely loved that knife moment 🔪 — when you told me you had one
            and actually showed it 😳😂. That gave me real killer vibes in the
            most hilarious, big-sister way. I was like, “Yep, I’m not messing
            with her today!” 😂 All of that — it felt like it came from a real
            big sister ❤️. And I absolutely loved that. Thank you for caring for
            me 🤗, roaming around with me 🚶‍♂️🚶‍♀️, giving me the feel of how fun
            and beautiful it is to have a big sister 👧, letting me irritate you
            just for fun 😜, eating with me 🍽️, and talking to me 💬. Please
            never change your attitude or mentality — it’s rare and precious ✨.
            And I know you’re going to achieve huge milestones in your career
            🎓💼🚀. Di, always stay kind to everyone 💖 — don’t carry hate in
            your heart. I don’t know how you see me 🤷‍♂️ — maybe immature or
            annoying — but these are my honest thoughts about you. Di, we may
            have argued a few times — not more than 3 or 4 — and I may have said
            something harsh that hurt you. For that, I’m truly sorry 🙏💔. On
            the day of Anand Bhaiya, you and me — whatever conversation we had,
            it was all because I started it. I regret saying things I shouldn’t
            have 😞. I know you saw me smiling that day, but the moment I
            noticed your mood change and the sadness in your eyes — I genuinely
            felt awful. It was the first time I ever saw someone have tears in
            their eyes because of me… and that crushed me inside. I’m really,
            really sorry for that. 😔 You can give me any punishment you want —
            I’ll accept it as a remedy for my mistake. You are the most
            beautiful person there — not just in looks, but in how bright,
            confident, and pure your smile is 🌟😊. Please always keep smiling
            like that, Di 💖. I truly hope we never lose the bond we’ve built
            and the connection of a brother and big sister 🤝👦👧 — it means the
            world to me. And one last thing… I’m really feeling bad about
            leaving you all 😔. It’s part of who I am — I often have to walk
            away from the people I build bonds with. Maybe that’s why I like
            being an introvert 🌌 — it protects me from the pain of parting. I
            don’t open up easily, Di. But with you — especially you — I did. I
            just hope you’ll remember me 🌠. And please, don’t ignore my
            messages after I leave. Even a simple reply from you — just checking
            in, saying hi, or asking how I am — would mean the world to me 🫂💬.
            Di, I hope you stay happy with your loved one 💑 and have a bright,
            fulfilling future ahead ✨. You deserve it all. And don’t worry —
            when we meet again, I’ll be more mature, more thoughtful. You’ll
            definitely see a change in me 🙏💫.Their is a button when you scroll
            down dedicated to you 😅
          </p>
          <div class="photo-gallery">
            <img src="1747112239477.jpg" alt="Sakshi Extra 1" />
            <img src="1746166511054.jpg" alt="Sakshi Extra 2" />
            <img src="1720469259785.jpg" alt="Sakshi Extra 3" />
            <img
              src="WhatsApp Image 2025-06-23 at 18.22.00_6bbffc67.jpg"
              alt="Sakshi Extra 4"
            />
            <img
              src="WhatsApp Image 2025-06-22 at 00.44.01_fe570723.jpg"
              alt="Sakshi Extra 5"
            />
            <img
              src="WhatsApp Image 2025-06-25 at 21.13.55_8b3bb490.jpg"
              alt="Sakshi 46"
            />
            <div class="button-container">
              <button class="btn-sakshi" onclick="goToSakshiPage()">
                Go to Sakshi's Page
              </button>
            </div>
          </div>
        </div>
      </div>
      <div id="image-popup" class="image-popup">
        <span class="close-popup" onclick="closeImagePopup()">&times;</span>
        <img id="popup-img" src="" alt="Full Size" />
      </div>
    </div>

    <script>
      function openImagePopup(src) {
        const popup = document.getElementById("image-popup");
        const popupImg = document.getElementById("popup-img");
        popupImg.src = src;
        popup.style.display = "flex";
      }

      function closeImagePopup() {
        document.getElementById("image-popup").style.display = "none";
      }

      document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll(".photo-gallery img").forEach((img) => {
          img.addEventListener("click", () => openImagePopup(img.src));
        });
      });
    </script>

    <script>
      let music = document.getElementById("bg-music");
      let niketWindow = null;
      let checkTab;

      function goToniketPage() {
        // Pause music
        if (music) {
          music.pause();
        }

        // Open Niket page in new tab
        localStorage.setItem("playMusic", "true");
        niketWindow = window.open("niket.html", "_blank");

        // Start checking if the new tab is closed
        checkTab = setInterval(() => {
          if (niketWindow && niketWindow.closed) {
            clearInterval(checkTab);
            if (music) {
              music.play(); // Resume music
            }
          }
        }, 1000); // check every 1 second
      }
    </script>

    <script>
      let music3 = document.getElementById("bg-music");
      let Somyawindow = null;
      let checkTab3;

      function goToSomyaPage() {
        // Pause music
        if (music3) {
          music3.pause();
        }

        // Open Somya page in new tab
        localStorage.setItem("playMusic", "true");
        Somyawindow = window.open("Somya.html", "_blank");

        // Start checking if the new tab is closed
        checkTab3 = setInterval(() => {
          if (Somyawindow && Somyawindow.closed) {
            clearInterval(checkTab3);
            if (music3) {
              music3.play(); // Resume music
            }
          }
        }, 1000); // check every 1 second
      }
    </script>

    <script>
      let music2 = document.getElementById("bg-music");
      let anandwindow = null;
      let checkTab2;

      function goToanandPage() {
        // Pause music
        if (music2) {
          music2.pause();
        }

        // Open Anand page in new tab
        localStorage.setItem("playMusic", "true");
        anandwindow = window.open("anand.html", "_blank");

        // Start checking if the new tab is closed
        checkTab2 = setInterval(() => {
          if (anandwindow && anandwindow.closed) {
            clearInterval(checkTab2);
            if (music2) {
              music2.play(); // Resume music
            }
          }
        }, 1000); // check every 1 second
      }
    </script>

    <script>
      let music1 = document.getElementById("bg-music");
      let Sakshiwindow = null;
      let checkTab1;

      function goToSakshiPage() {
        // Pause music
        if (music1) {
          music1.pause();
        }

        // Open Niket page in new tab
        localStorage.setItem("playMusic", "true");
        Sakshiwindow = window.open("Sakshi.html", "_blank");

        // Start checking if the new tab is closed
        checkTab1 = setInterval(() => {
          if (Sakshiwindow && Sakshiwindow.closed) {
            clearInterval(checkTab1);
            if (music1) {
              music1.play(); // Resume music
            }
          }
        }, 1000); // check every 1 second
      }
    </script>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script>
      let confettiInstance;

      function openModal(id) {
        const clickSound = document.getElementById("click-sound");
        clickSound.currentTime = 0;
        clickSound
          .play()
          .catch((error) => console.error("Error playing click sound:", error));

        const modal = document.getElementById(id);
        modal.style.display = "flex";

        confettiInstance = setInterval(() => {
          confetti({
            particleCount: 50,
            spread: 120,
            startVelocity: 45,
            origin: { y: 0.8, x: Math.random() },
            colors: ["#ff0000", "#00ff00", "#0000ff", "#ffff00", "#ff00ff"],
          });
        }, 150);
        setTimeout(() => clearInterval(confettiInstance), 2500);

        const images = modal.querySelectorAll(".photo-gallery img");
        images.forEach((img) => {
          img.classList.remove("fade-zoom");
          void img.offsetWidth; // Trigger reflow
          img.classList.add("fade-zoom");
        });
      }

      function closeModal(id) {
        const modal = document.getElementById(id);
        const content = modal.querySelector(".modal-content");

        content.classList.add("closing");

        setTimeout(() => {
          modal.style.display = "none";
          content.classList.remove("closing");
        }, 300);

        if (confettiInstance) {
          clearInterval(confettiInstance);
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        const startBtn = document.getElementById("start-btn");
        const funnyText = document.getElementById("funny-line");
        const intro = document.getElementById("intro-overlay");
        const mainSky = document.querySelector(".sky");
        const bgMusic = document.getElementById("bg-music");
        const typeSound = document.getElementById("type-sound");
        const starsContainer = document.querySelector(".stars");
        const typingHeading = document.querySelector(".typing");
        const authorName = document.getElementById("author-name"); // Get the author name element

        // NEW: Get the image-wrapper and crazy-img elements
        const imageWrapper = document.querySelector(".image-wrapper");
        const crazyImages = imageWrapper.querySelectorAll(".crazy-img");

        let continuousStarInterval;
        let meteorShowerTimeout;
        let meteorShowerActive = false;
        let activeShootingStarsCount = 0;
        let dynamicStylesheet;

        if (document.styleSheets.length === 0) {
          const style = document.createElement("style");
          document.head.appendChild(style);
        }
        dynamicStylesheet = document.styleSheets[0];

        const MIN_STARS_ALWAYS_VISIBLE = 6;
        const METEOR_SHOWER_MIN_BURST = 8;
        const METEOR_SHOWER_MAX_BURST = 15;
        const TOTAL_SHOWER_STARS_CAP = 120;

        // REMOVE the old animateGPImages() if you are not using it.
        // If you want to keep the old one-by-one animation, you'll need to
        // re-evaluate the flow and maybe rename this new function.
        // For now, I'm assuming the new "scattered then grid" is what you want.

        function animateCollageReveal() {
          // Initial state for the collage wrapper
          imageWrapper.style.display = "block"; // Make sure wrapper is visible
          imageWrapper.style.opacity = 0; // Start faded out
          imageWrapper.classList.remove("final-layout"); // Ensure no final layout class initially

          const placedImages = []; // To store the rectangles of placed images

          // Step 1: Random initial positions/sizes before reveal, avoiding overlaps
          crazyImages.forEach((img) => {
            let placed = false;
            let attempts = 0;
            const maxAttempts = 100; // Limit attempts to prevent infinite loops

            while (!placed && attempts < maxAttempts) {
              const size = 150 + Math.random() * 100; // Sizes between 150px and 250px
              // Use a buffer to ensure images don't go off-screen and have some margin
              const buffer = 50;
              const randomTop = Math.floor(
                Math.random() * (window.innerHeight - size - buffer * 2) +
                  buffer
              );
              const randomLeft = Math.floor(
                Math.random() * (window.innerWidth - size - buffer * 2) + buffer
              );

              const newRect = {
                left: randomLeft,
                top: randomTop,
                right: randomLeft + size,
                bottom: randomTop + size,
              };

              let overlaps = false;
              for (const existingRect of placedImages) {
                // Simple AABB collision detection
                if (
                  newRect.left < existingRect.right &&
                  newRect.right > existingRect.left &&
                  newRect.top < existingRect.bottom &&
                  newRect.bottom > existingRect.top
                ) {
                  overlaps = true;
                  break;
                }
              }

              if (!overlaps) {
                img.style.width = size + "px";
                img.style.height = size + "px";
                img.style.top = newRect.top + "px";
                img.style.left = newRect.left + "px";
                img.style.transform =
                  "scale(0.8) rotate(" + (Math.random() * 60 - 30) + "deg)";
                img.style.opacity = 0; // Ensure hidden
                img.style.position = "absolute"; // Ensure absolute for scatter

                placedImages.push(newRect); // Store the successfully placed image's rectangle
                placed = true;
              }
              attempts++;
            }

            // If maxAttempts reached and still overlapping, place it anyway
            if (!placed) {
              // console.warn("Could not find non-overlapping spot for an image after max attempts.");
              // Fallback: Just place it randomly if overlap couldn't be avoided
              const size = 150 + Math.random() * 100;
              img.style.width = size + "px";
              img.style.height = size + "px";
              img.style.top =
                Math.floor(Math.random() * (window.innerHeight - size)) + "px";
              img.style.left =
                Math.floor(Math.random() * (window.innerWidth - size)) + "px";
              img.style.transform =
                "scale(0.8) rotate(" + (Math.random() * 60 - 30) + "deg)";
              img.style.opacity = 0;
              img.style.position = "absolute";
            }
          });

          // Fade in the whole wrapper
          setTimeout(() => {
            imageWrapper.style.opacity = 1;
          }, 100); // Small delay to allow initial setup to apply

          // Step 2: Reveal with animation one by one
          crazyImages.forEach((img, index) => {
            setTimeout(() => {
              img.style.opacity = 1;
              img.style.transform =
                "scale(1) rotate(" + (Math.random() * 30 - 15) + "deg)";
            }, index * 400 + 500); // Staggered reveal + initial delay
          });

          // Step 3: Transition to final fullscreen grid layout after individual animations complete
          const totalIndividualAnimationTime = crazyImages.length * 400;
          const delayBeforeGridTransition = 1500;
          const gridTransitionDuration = 1000;

          setTimeout(() => {
            // Apply the grid layout to the wrapper
            imageWrapper.classList.add("final-layout");

            // Fade out the collage after it has been in the grid layout for a bit
            setTimeout(() => {
              imageWrapper.style.opacity = 0; // Fade out the entire collage
              setTimeout(() => {
                imageWrapper.style.display = "none"; // Hide after fading
                showIntroOverlay(); // Trigger the intro-overlay after collage fades out
                console.log("Collage faded out, moving to intro overlay.");
              }, 1000); // Duration of fade-out
            }, gridTransitionDuration + 2000); // Show collage for 2 seconds in grid before fading out
          }, totalIndividualAnimationTime + delayBeforeGridTransition);
        }

        function showIntroOverlay() {
          const intro = document.getElementById("intro-overlay");
          const mainSky = document.querySelector(".sky");
          const typingHeading = document.querySelector(".typing");

          intro.style.display = "flex"; // Make intro overlay visible
          setTimeout(() => {
            intro.classList.add("active"); // Start fade in

            setTimeout(() => {
              intro.classList.add("fade-out"); // Start fade out

              setTimeout(() => {
                intro.style.display = "none"; // Hide after fade out
                mainSky.classList.add("show"); // Show main sky content
                typingHeading.classList.add("start-typing", "bouncy"); // Start typing animation

                document.querySelectorAll(".floating-text").forEach((ft) => {
                  ft.style.opacity = 1;
                });

                // Show author name here
                authorName.style.opacity = 1;
                authorName.classList.add("show-name"); // Add class for transition

                setTimeout(() => {
                  document
                    .querySelector(".card-container")
                    .classList.add("show-cards");
                }, 4000);

                setTimeout(() => {
                  document.querySelector("footer").classList.add("show-footer");
                }, 6000);

                startContinuousShootingStars();
                scheduleMeteorShower();
              }, 2000); // Delay for intro overlay fade-out
            }, 3000); // Delay before intro starts fading out
          }, 50);
        }

        startBtn.addEventListener("click", async () => {
          try {
            await bgMusic.play();
            console.log("Background music started successfully.");
          } catch (error) {
            console.error("Error playing background music:", error);
            alert(
              "Audio playback failed. Please allow audio for this site or click anywhere to enable sound."
            );
          }

          const funnyLines = [
            "🚀 Launching Feelz Rocket...",
            "💖 Packing gratitude...",
            "🎯 Target locked: Hearts!",
            "✨ Countdown started...",
            "P.S. Hope you brought snacks!",
            "Brace for maximum appreciation!",
          ];

          let i = 0;

          function typeNext() {
            if (i < funnyLines.length) {
              funnyText.textContent = funnyLines[i];
              typeSound.currentTime = 0;
              typeSound
                .play()
                .catch((error) =>
                  console.error("Error playing type sound:", error)
                );
              i++;
              setTimeout(typeNext, 700);
            } else {
              document.getElementById("start-overlay").style.display = "none";
              animateCollageReveal(); // Call the new collage animation after typing
            }
          }
          typeNext();
        });

        const removeKeyframes = (name) => {
          for (let i = 0; i < dynamicStylesheet.cssRules.length; i++) {
            if (dynamicStylesheet.cssRules[i].name === name) {
              dynamicStylesheet.deleteRule(i);
              break;
            }
          }
        };

        for (let i = 0; i < 8; i++) {
          createGlowingCircle();
        }

        const createShootingStar = (
          customStartX = null,
          customStartY = null,
          customAngle = null,
          customDuration = null
        ) => {
          const shoot = document.createElement("div");
          shoot.classList.add("shooting-star");

          const viewportWidth = window.innerWidth;
          const viewportHeight = window.innerHeight;

          let startX, startY;
          if (customStartX !== null && customStartY !== null) {
            startX = customStartX;
            startY = customStartY;
          } else {
            const edgeChoice = Math.random();
            if (edgeChoice < 0.5) {
              startX = Math.random() * viewportWidth * 0.8;
              startY = -100;
            } else {
              startX = -100;
              startY = Math.random() * viewportHeight * 0.8;
            }
          }

          const angle =
            customAngle !== null ? customAngle : Math.random() * 40 + 30;

          const travelDistance = Math.random() * 1000 + 1500;

          const angleRad = angle * (Math.PI / 180);
          const endX = startX + travelDistance * Math.cos(angleRad);
          const endY = startY + travelDistance * Math.sin(angleRad);

          const duration =
            customDuration !== null
              ? customDuration
              : Math.random() * 1.5 + 3.5;
          const delay = 0;

          const animationName = `shoot-star-${Date.now()}-${Math.random()
            .toString(36)
            .substring(7)}`;

          const keyframesRule = `@keyframes ${animationName} {
                                                from {
                                                    transform: translate(${startX}px, ${startY}px) rotate(${angle}deg);
                                                    opacity: 0.8;
                                                }
                                                to {
                                                    transform: translate(${endX}px, ${endY}px) rotate(${angle}deg);
                                                    opacity: 0;
                                                }
                                            }`;
          try {
            dynamicStylesheet.insertRule(
              keyframesRule,
              dynamicStylesheet.cssRules.length
            );
          } catch (e) {
            console.warn("Failed to insert keyframe rule:", e);
            return;
          }

          shoot.style.animation = `${animationName} ${duration}s linear ${delay}s forwards`;
          shoot.style.width = `${Math.random() * 100 + 150}px`;
          shoot.style.height = `3px`;

          starsContainer.appendChild(shoot);
          activeShootingStarsCount++;

          shoot.addEventListener("animationend", () => {
            shoot.remove();
            activeShootingStarsCount--;
            removeKeyframes(animationName);
          });
        };

        const startContinuousShootingStars = () => {
          continuousStarInterval = setInterval(() => {
            if (
              !meteorShowerActive &&
              activeShootingStarsCount < MIN_STARS_ALWAYS_VISIBLE
            ) {
              createShootingStar();
            } else if (
              meteorShowerActive &&
              activeShootingStarsCount > TOTAL_SHOWER_STARS_CAP + 50
            ) {
              // Safety valve
            }
          }, 300);
        };

        const startMeteorShower = () => {
          if (meteorShowerActive) return;

          meteorShowerActive = true;
          console.log("Meteor Shower START!");

          let showerStarsGenerated = 0;
          const showerBurstInterval = 100;

          const showerRepeater = setInterval(() => {
            if (showerStarsGenerated < TOTAL_SHOWER_STARS_CAP) {
              const starsInThisBurst =
                Math.floor(
                  Math.random() *
                    (METEOR_SHOWER_MAX_BURST - METEOR_SHOWER_MIN_BURST + 1)
                ) + METEOR_SHOWER_MIN_BURST;

              for (let i = 0; i < starsInThisBurst; i++) {
                const startX = Math.random() * window.innerWidth * 0.4;
                const startY = Math.random() * window.innerHeight * 0.3 - 50;
                const angle = Math.random() * 20 + 50;
                const duration = Math.random() * 1 + 2.5;
                const delay = Math.random() * 0.5;
                setTimeout(
                  () => createShootingStar(startX, startY, angle, duration),
                  delay * 1000
                );
              }
              showerStarsGenerated += starsInThisBurst;
            } else {
              clearInterval(showerRepeater);
              meteorShowerActive = false;
              console.log("Meteor Shower END!");
              scheduleMeteorShower();
            }
          }, showerBurstInterval);
        };

        const scheduleMeteorShower = () => {
          const nextShowerDelay = Math.random() * 45000 + 30000;
          meteorShowerTimeout = setTimeout(startMeteorShower, nextShowerDelay);
        };

        function createGlowingCircle() {
          const circle = document.createElement("div");
          circle.classList.add("glowing-circle");

          const size = Math.random() * 40 + 20;
          circle.style.width = `${size}px`;
          circle.style.height = `${size}px`;
          circle.style.left = `${Math.random() * 100}vw`;
          circle.style.top = `${Math.random() * 100}vh`;
          circle.style.animationDelay = `${Math.random() * 2}s`;

          const colors = [
            { base: "255, 0, 153" },
            { base: "0, 200, 255" },
            { base: "255, 255, 0" },
            { base: "144, 238, 144" },
          ];

          const selected =
            colors[Math.floor(Math.random() * colors.length)].base;

          circle.style.background = `radial-gradient(
                                    circle,
                                    rgba(255, 255, 255, 0) 60%,
                                    rgba(${selected}, 0.15) 75%,
                                    rgba(${selected}, 0.3) 85%,
                                    rgba(255, 255, 255, 0) 100%
                                )`;

          document.querySelector(".stars").appendChild(circle);
        }

        for (let i = 0; i < 400; i++) {
          const star = document.createElement("span");
          Object.assign(star.style, {
            position: "absolute",
            width: `${Math.random() * 2 + 1}px`,
            height: `${Math.random() * 2 + 1}px`,
            borderRadius: "50%",
            background: "white",
            top: `${Math.random() * 100}vh`,
            left: `${Math.random() * 100}vw`,
            animation: "blinkStar 2s infinite ease-in-out",
            animationDelay: `${Math.random() * 5}s`,
            opacity: 0.2,
          });
          starsContainer.appendChild(star);
        }

        document.querySelectorAll(".card-image-slider").forEach((slider) => {
          const images = slider.querySelectorAll("img");
          let current = 0;
          if (images.length > 0) {
            images[current].classList.add("active");
          }

          setInterval(() => {
            if (images.length === 0) return;
            images[current].classList.remove("active");
            current = (current + 1) % images.length;
            images[current].classList.add("active");
          }, 2000);
        });

        document.addEventListener("mousemove", (e) => {
          const star = document.createElement("div");
          star.classList.add("cursor-trail-star");
          star.textContent = "★";

          star.style.left = `${e.clientX}px`;
          star.style.top = `${e.clientY}px`;

          document.body.appendChild(star);

          setTimeout(() => {
            star.remove();
          }, 800);
        });
      });
    </script>
  </body>
</html>
